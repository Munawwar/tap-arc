#!/usr/bin/env node

const { pipeline } = require("stream");
const tapSpek = require("..")();

pipeline(process.stdin, tapSpek, process.stdout, (err) => {
	if (err) console.error("Pipeline failed.", err);
});

tapSpek.on("end", function () {
	if (tapSpek.count < 1) process.exit(1);
	if (tapSpek.failures.length > 0) process.exit(1);
});
